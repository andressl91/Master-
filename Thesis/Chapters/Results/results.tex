\chapter{Numerical Results}

In this chapter the numerical results for this thesis will be presented. The first and section chapters conserns the verification and validation of the \textit{One-step $\theta$} scheme respectivly. In the third and final chapter, different speed-up strategies are presented and compared

\section{Verification}


\section{Validation of a One-step $\theta$ scheme}
The numerical benchmark presented in \cite{Hron2006} has been chosen for validation of the \textit{One-step $\theta$} scheme presented in chapter. The benchmark has been widely accepted throughout the fluid-structure interaction community as a rigid validation benchmark. This is mainly due to the diversity of tests included, challenging all the main components of a fluid-structure interaction scheme. \\

The computational domain is based on the \textit{von Kármán vortex street} se (cite), where a cylinder is intentionally placed off center in a pipe. This configuration initiates a periodic shedding of vortices, as some fluid moves past the cylinder. In \cite{Hron2006}, an elastic flag is placed behind the cylinder. \\

\begin{figure}[h!]
  \centering
    \includegraphics[scale=0.5]{./Fig/turekflag.png}
      \caption{Computational domain of the validation benchmark}
\end{figure}
\newpage


The benchmark is divided into three main test environments.
In the first environment the fluid solver is tested. \\
The second environment regards the structure implementation, regarding bending of the elastic flag. The third environment the full fluid-structure interaction problem.
The test environments are further divided into three different problems with increasing difficulty, posing different challenges to the implementation.

 Several quantites for comparion is presented in \cite{Hron2006} for validation purposes. The evaluation of these quantities are considered for fully developed flow, 

\begin{itemize}
\item The position (x,y) of point A(t) as the elastic flag undergoes deformation.
\item Drag and lift forces exerted on of the whole interior geometry in contact with the fluid, consisting of the rigid circle and the elastic beam.
\begin{align*}
(F_D, F_L) = \int_{\Gamma} \mathbf{\sigma} \cdot \mathbf{n} dS
\end{align*}
\end{itemize}

The flowing environments and their sub-problems presents both steady state and periodic solutions. For the steady state solutions, the quantity of interest will be calculated for the last timestep. For the periodic solutions, the amplitude and mean values for the time dependent properties are calculated from the last period of oscillations. In\cite{Hron2006}, details such as  finite-element spaces and newton iteration critera are not reported. Therefore, the following numerical results have been a process of trial and error. In the following section, an overview of each environment togheter with  the numerical results be presented.  with comparison to \cite{Hron2006} and .. 
 
 \newpage
\subsection{Validation of fluid solver} 
The first test environment conserns the fluid dynamics part of the total FSI problem, to ensure the solver can handle flows in low Reynold-numbers regime.  The validation of the fluid solver is divided into the three sub-cases CFD1, CFD2 and CFD3.While  CFD1 and CFD2 yields steady state solutions, CFD3 is a periodic solution.

%\begin{figure}[h!]
  %\centering
    %\includegraphics[scale=0.3]{./Fig/cfd1mesh.png}
      %\caption{Computational domain of channel flow with rigid inner geometry. }
%\end{figure}

\begin{table}[h!]
\centering
\caption{Benchmark environment}
\label{my-label}
\begin{tabular}{ |p{3cm}||p{2cm}|p{2cm}|p{2cm}|  }
 \hline
 \multicolumn{4}{|c|}{Fluid parameters} \\
 \hline
 parameter              & CFD 1 & CFD 2 & CFD 3 \\
 \hline
$\rho^f [10^{3}\frac{kg}{m^3}]$ & 1    & 1    & 1    \\
$\nu^f  [10^{-3}\frac{m^2}{s}]$  & 1    & 1    & 1    \\
U                      & 0.2  & 1    & 2    \\
Re                     & 20   & 100  & 200 \\
\hline
\end{tabular}
\end{table}

A parabolic velocity profile on the form,
\begin{align*}
v_f(0, y) = 1.5 U\frac{(H -y)y}{(\frac{H}{2})^2}
\end{align*}
is set on the left channel inflow. H is the height of the channel, while the parameter U is set differently to each problem to induce different flow profiles. \

At the right channel outflow, the pressure is set to $p = 0$. \
No-slip boundary conditions for the fluid are enforced on the channel walls, and on the inner geometry consisting of the circle and the elastic flag. 
The validation is based on the evaluation of drag and lift forces on the inner geometry for each sub-case.  with comparison to \cite{Hron2006}. The following tables presents the numerical results for each sub-case. 


\begin{table}[h!]
\centering
\caption{CFD 1 Results}
\label{CFD 1 Results}
\begin{tabular}{ |p{1cm}||p{2.7cm}|p{2.5cm}|p{2.5cm}|}
\hline
nel & ndof & Drag  & Lift \\
\hline
 1438    & 6881   (P2-P1) & 13.60 & 1.0899 \\
 2899    & 13648 (P2-P1)& 14.05 & 1.1261 \\
 7501    & 34657 (P2-P1) & 14.17   & 1.109 \\
 19365   & 88520 (P2-P1) & 14.20 & 1.119 \\
  \hline
  \multicolumn{2}{|c|}{Reference}  & 14.29   & 1.119\\
   \hline
\end{tabular}
\end{table}

\begin{table}[h!]
\centering
\caption{CFD 2 Results}
\label{CFD-2 Results}
\begin{tabular}{ |p{1cm}||p{2.7cm}|p{2.5cm}|p{2.5cm}|}
\hline
nel & ndof & Drag  & Lift \\
\hline
 1438    & 6881  (P2-P1) & 126.0 &  8.62 \\
 2899    & 13648  (P2-P1)& 131.8 & 10.89  \\
 7501    & 34657  (P2-P1)& 135.1 & 10.48  \\
 19365   & 88520 (P2-P1) & 135.7 &10.55  \\
  \hline
  \multicolumn{2}{|c|}{Reference}  & 136.7  & 10.53\\
   \hline
\end{tabular}
\end{table}

\begin{table}[h!]
\centering
\caption{CFD 3 Results}
\label{CFD-3 Results}
\begin{tabular}{ |p{1cm}||p{2.7cm}|p{2.9cm}|p{2.9cm}|}
\hline
nel & ndof & Drag  & Lift \\
\hline
 1438    & 6881 (P3-P2)  & 414.86  $\pm$ 5.63 & -7.46 $\pm$  444.07 \\
 2899    & 13648 (P3-P2) & 432.86 $\pm$  5.50 & -9.69  $\pm$ 431.29 \\
 7501    & 34657 (P3-P2) &                        &                         \\
 19365   & 88520 (P3-P2) &                        &                         \\
  \hline
  \multicolumn{2}{|c|}{Reference}  & 439.45 $\pm$ 5.6183  &  -11.893 $\pm$437.81\\
   \hline
\end{tabular}
\end{table}



\newpage
\subsection{Validation of solid solver}
The first validation 



\newpage
\subsection{Validation of fluid structure interaction solver}
The validation of the FSI solver constist of three sub-cases which will be referred to FSI1, FS2 and FSI3. For all sub-cases
a parabolic velocity profile on the form,
\begin{align*}
v_f(0, y) = 1.5 U\frac{(H -y)y}{(\frac{H}{2})^2}
\end{align*}
is set on the left channel inflow. H is the height of the channel, while the parameter U is set differently to each problem to induce different flow profiles. \
At the right channel outflow, the pressure is set to $p = 0$. \
No-slip boundary conditions for the fluid are enforced on the channel walls, and on the circle of the inner geometry. 
The structure deformation and velocity is set to zero on the left side of the flag, where the flag is ancored to the circle. On the fluid-structure interface $\Gamma$, we enfore the kinematic and dynamic boundary condition
\begin{align}
\mathbf{v}_f = \mathbf{v}_s \\
\mathbf{\sigma}_f \cdot \mathbf{n} = \mathbf{\sigma}_s \cdot \mathbf{n}
\end{align}
From chapter ?,  (1.1) is enforced strongly due to the continious velocity field, while (1.2) is enforced weakly by omtitting form the weak formulation by.



The main purpose of the validation of the fluid solver twofold: 
Apart from the accuracy of the reported values, the purpose of the fsi validation can be divided into two parts. Firstly, it is of great importance to ensure that the overall coupling of the fluid-structure interaction problem are executed correctly. Second, a good choice of mesh extrapolation modle is essential to ensure mesh entanglement in the fluid mesh. 


\begin{table}[h!]
\centering
\caption{Benchmark environment}
\label{my-label}
\begin{tabular}{ |p{3cm}||p{2cm}|p{2cm}|p{2cm}|  }
 \hline
 \multicolumn{4}{|c|}{Solid parameters} \\
 \hline
 parameter              & FSI1 & FSI2 & FSI3 \\
 \hline
 $\rho^s [10^{3} \frac{kg}{m^3}]$ & 1    & 10   & 1    \\
$\nu^s$ & 0.4  & 0.4  & 0.4  \\
$\mu^s  [10^{6}\frac{kg}{ms^2}]$  & 0.5  & 0.5  & 2.0  \\
 \hline
 \multicolumn{4}{|c|}{Fluid parameters} \\
 \hline
$\rho^f [10^{3}\frac{kg}{m^3}]$ & 1    & 1    & 1    \\
$\nu^f  [10^{-3}\frac{m^2}{s}]$  & 1    & 1    & 1    \\
U                      & 0.2  & 1    & 2    \\
parameter              & FSI1 & FSI2 & FSI3 \\
Re                     & 20   & 100  & 200 \\
\hline
\end{tabular}
\end{table}

\newpage
\subsubsection{FSI1}
The first environment yields a steady state solution for the system, inducing small deformations to the elastic flag. This environment is exelent to ensure the overall coupling of the FSI-problem is exectuted properly. In Tabel 1, simulations with different mesh extrapolation operators are presented.

\begin{table}[h!]
\centering
\caption{FSI 1 Results}
\label{FSI1 Results}
\begin{tabular}{ |p{1cm}||p{1cm}|p{2.5cm}|p{2.5cm}|p{2.7cm}|p{2.7cm}|p{1.2cm}|}
 \hline
  \multicolumn{6}{|c|}{Laplace} \\
   \hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 \hline
 2474    & 21249  &       0.0226 &       0.8200 & 14.061 & 0.7542 \\
 7307    & 63365  &       0.0227 &       0.7760 & 14.111 & 0.7517 \\
 11556   & 99810  &       0.0226 &      0.8220 & 14.201 & 0.7609 \\
  \hline 
 REF     & REF    &       0.0227      &       0.8209      & 14.295  & 0.7638   \\
 \hline
\end{tabular}
\begin{tabular}{ |p{1cm}||p{1cm}|p{2.5cm}|p{2.5cm}|p{2.7cm}|p{2.7cm}|p{1.2cm}|}
 \hline
  \multicolumn{6}{|c|}{Linear Elastic} \\
   \hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 \hline
 2474    & 21249  &       0.0226 &       0.8198 & 14.061 & 0.7541 \\
 7307    & 63365  &       0.0227 &       0.7762 & 14.111 & 0.751  \\
 11556   & 99810  &       0.0226  &       0.8222 & 14.201 & 0.7609 \\
  \hline 
 REF     & REF    &       0.0227      &       0.8209      & 14.295  & 0.7638   \\
 \hline
\end{tabular}
\begin{tabular}{ |p{1cm}||p{1cm}|p{2.5cm}|p{2.5cm}|p{2.7cm}|p{2.7cm}|p{1.2cm}|}
 \hline
  \multicolumn{6}{|c|}{Biharmonic bc1} \\
   \hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 \hline
 2474    & 21249  &       0.0226 &       0.8200 & 14.061 & 0.7541 \\
 7307    & 63365  &       0.0227  &       0.7761 & 14.111 & 0.7517 \\
 11556   & 99810  &       0.0227  &       0.8017 & 14.205 & 0.9248 \\
  \hline 
 REF     & REF    &       0.0227      &       0.8209      & 14.295  & 0.7638   \\
 \hline
\end{tabular}
\begin{tabular}{ |p{1cm}||p{1cm}|p{2.5cm}|p{2.5cm}|p{2.7cm}|p{2.7cm}|p{1.2cm}|}
 \hline
  \multicolumn{6}{|c|}{Biharmonic bc2} \\
   \hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 \hline
 2474    & 21249  &       0.0226 &       0.8200 & 14.061 & 0.7543 \\
 7307    & 63365  &       0.0227 &       0.7761 & 14.111 & 0.7518 \\
 11556   & 99810  &       0.0227 &       0.8020 & 14.205 & 0.9249  \\
  \hline 
 REF     & REF    &       0.0227      &       0.8209      & 14.295  & 0.7638   \\
 \hline
\end{tabular}
\end{table}


\begin{table}[h!]
\centering
\caption{FSI 1 - No extrapolation}
\label{FSI1- No extrapolation}
\begin{tabular}{ |p{1cm}||p{1cm}|p{2.5cm}|p{2.5cm}|p{2.7cm}|p{2.7cm}|p{1.2cm}|}
 \hline
  \multicolumn{6}{|c|}{No extrapolation} \\
   \hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 \hline
 2474    & 21249  &       0.0224 &       0.9008 & 14.064 & 0.7713 \\
 7307    & 63365  &       0.0226  &       0.8221 & 14.117 & 0.7660 \\
 11556   & 99810  &       0.0225 &       0.8787 & 14.212 & 0.7837 \\
  \hline 
 REF     & REF    &       0.0227      &       0.8209      & 14.295  & 0.7638   \\
 \hline
\end{tabular}

\end{table}


However, due to the small deformations of order $10^{-6}$, FSI1 doesn't provide a rigorous test of the chosen mesh extrapolation model. By omitting mesh extrapolation from the variatonal formulation,  reasonable results are still obtained. This proves that the FSI-1 validation case can be misguiding, in terms of choice of mesh extrapolation model is not essential. 


\newpage \newpage
\subsubsection{FSI2}
The second environment results in a periodic solution, where the elastic flag oscilates behind the sylinder. 
The FSI2 case proved to be one of the most demanding tests, due to the large deformation of the elastic flag. leading to the risk of entangled mesh cells. Therefore a high quality extrapolation of the solid deformation into the fluid is needed.

\subsubsection{FSI3}
The final environment does not induce deformation to the extent of the FSI2 benchmark. However a critical phase in the transition to the periodic solution was discovered, where the pressure oscillation induces a large deformation to the system.

\begin{table}[h!]
\centering
\caption{FSI 3 - Laplace}
\label{my-label}
\begin{tabular}{ |p{1cm}||p{1cm}|p{2.5cm}|p{2.5cm}|p{2.7cm}|p{2.7cm}|p{1.2cm}|}
 \hline
  \multicolumn{6}{|c|}{$\Delta t = 0.01 \theta = 0.51$} \\
   \hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 \hline
 2474    & 21249  & -2.41      $\pm$ 2.41 & 1.49       $\pm$ 3.22 & 449.40       $\pm$ 14.70 & 0.55       $\pm$ 155.80  \\
 7307    & 63365  & -2.32       $\pm$ 2.30 & 1.34       $\pm$ 3.17 & 451.78       $\pm$ 16.08 & 1.13       $\pm$ 151.22  \\
 11556   & 99810  & -2.34       $\pm$ 2.34 & 1.57       $\pm$ 3.19 & 455.92       $\pm$ 17.32 & -0.10       $\pm$ 151.03 \\
 \hline
  \multicolumn{6}{|c|}{$\Delta t = 0.001 \theta = 0.501$} \\
   \hline
 nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
1216 &5797& --2.17$\pm$  2.08 &     3.32     $\pm$  29.07 &439.98 $\pm$  14.08  &  1.91 $\pm$  151.71\\
2295 &10730& -3.04 $\pm$  2.88 &  1.51  $\pm$  35.88 & 452.04  $\pm$  22.41 &  3.30      $\pm$  160.11 \\
5963 &27486 & -3.03$\pm$  2.85 &  1.23 $\pm$  35.97  & 459.45  $\pm$  23.80 &  1.53  $\pm$  160.14 \\
\hline
\multicolumn{6}{|c|}{$\Delta t = 0.001 \theta = 0.5$} \\
   \hline
 nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
\hline
\end{tabular}
\end{table}
\newpage
\begin{figure}
    \includegraphics[scale=0.5]{./Fig/la_lift.png}
      \caption{Harmonic extrapolation, lift around geometry}
\end{figure}

\newpage


\begin{table}[h!]
\centering
\caption{FSI 3 - Biharmonic BC1}
\label{my-label}
\begin{tabular}{ |p{0.9cm}||p{0.9cm}|p{2.49cm}|p{2.49cm}|p{2.6cm}|p{2.8cm}|}
 \hline
  \multicolumn{6}{|c|}{$\Delta t = 0.01 \theta = 0.51$} \\
   \hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 \hline
 %2474    & 21249 & 7.96  $\pm$ 8.10  & -3.84   $\pm$ 1.02 & 450.16  $\pm$ 15.11 & $-20.09 \pm 148.17 $\\
 2474     &21249  &7.96  $\pm$ 8.10  &  -3.84   $\pm$ 1.02 & 450.16  $\pm$ 15.11  & -20.09 $\pm$ 148.17 \\
 7307    & 63365  & 3.10  $\pm$ 3.06  & -1.90   $\pm$ 4.21 & 457.37  $\pm$ 15.24 & -51.77 $\pm$ 127.28 \\
 11556   & 99810  & -2.18  $\pm$ 9.65 & 1.31    $\pm$ 4.93  & 456.40 $\pm$ 17.45 &  0.45 $\pm$ 149.68  \\
 \hline
  \multicolumn{6}{|c|}{$\Delta t = 0.001 \theta = 0.501$} \\
   \hline
 nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
1216 &5797  & -2.18       $\pm$ 2.10 & 3.56   $\pm$ 2.90 & 435.19       $\pm$ 9.77  & -1.57       $\pm$ 151.43 \\
7307    & 63365  & -1.42  $\pm$ 4.70 & 7.77   $\pm$ 2.85 & 454.38       $\pm$ 19.75 & 17.97       $\pm$ 155.08 \\
11556   & 99810  & -2.23  $\pm$ 6.16 & 1.72   $\pm$ 4.48 & 459.12       $\pm$ 22.97 & -3.12       $\pm$ 171.22 \\
\hline
\multicolumn{6}{|c|}{$\Delta t = 0.001 \theta = 0.5$} \\
   \hline
 nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
\hline
1216 &  5797  & -2.18       $\pm$ 2.10 & 3.56  $\pm$ 29.04  & 440.25       $\pm$ 14.42 & -1.81       $\pm$ 150.98  \\
7307    & 63365  & para & para $\pm$ para & 455.25 $\pm$ 20.56 & -51.89  $\pm$ 136.59 \\
11556   & 99810  & -2.23  $\pm$ para & para $\pm$ para & 459.13 $\pm$ 22.98 & -3.11 $\pm$ 171.23  \\
\hline
\hline
 REF     & REF    & -2.69 $\pm$ 2.56    & 1.48 $\pm$ 34.38   & 457.3 $\pm$ 22.66  & 2.22 $\pm$ 149.78   \\
\hline
\end{tabular}
\end{table}
\begin{figure}
  \centering
    \includegraphics[scale=0.5]{./Fig/bi_lift.png}
      \caption{Biharmonic extrapolation, lift around geometry}
\end{figure}

\begin{figure}
    \includegraphics[scale=0.5]{./Fig/compare.png}
      \caption{Compare}
\end{figure}

\begin{table}[h!]
\centering
\caption{FSI 3 - Biharmonic BC2}
\label{my-label}
\begin{tabular}{ |p{1cm}||p{1cm}|p{2.5cm}|p{2.5cm}|p{2.7cm}|p{2.7cm}|p{1.2cm}|}
 \hline
  \multicolumn{6}{|c|}{$\Delta t = 0.01 \theta = 0.51$} \\
   \hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 \hline
1216 &5797& -1.74  $\pm$  1.76 & 3.56 $\pm$  26.01 & 439.41$\pm$ 12.21  & -1.35    $\pm$  138.74\\
2295 &10730 & -2.39   $\pm$  2.40 &  1.76  $\pm$  32.27 & 449.71$\pm$ 18.16 &  3.71   $\pm$  149.97\\
 \hline
  \multicolumn{6}{|c|}{$\Delta t = 0.001 \theta = 0.501$} \\
   \hline
 nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 1216 &5797& -3.39   $\pm$  3.38 &   1.23   $\pm$  36.61 &   413.26 $\pm$  51.82  &   57.19  $\pm$  222.65\\
 2295 &10730& -4.70  $\pm$  4.71& 1.49       $\pm$  44.62& 427.91$\pm$  93.17 &  44.38  $\pm$  268.05 \\
\hline
\multicolumn{6}{|c|}{$\Delta t = 0.001 \theta = 0.5$} \\
   \hline
 nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
\hline
1216 &5797&-2.17$\pm$  2.09 & 3.54  $\pm$  28.95 & 440.13  $\pm$  14.45  &  -1.38  $\pm$  150.96\\
\hline
\end{tabular}
\end{table}


\section{Mesh movement}
The final enviroment
