\chapter{Verification and Validation}
 Computer simulations are in many engineering applications a cost-efficient way for conducting design and performance optimalization of physical problems. However, thrusting blindly numbers generated from a computer code can prove to be naive. It doesn't take a lot of coding experience before one realizes the many things that can brake down and produce unwanted or unexpected results. 
Therefore, \textit{credability} of computational results are essential, meaning the simulation is worthy of belief or confidence \cite{Oberkampf2010}. \textit{Verification and validation} (V\&V) is the main approach for assessing and the reliability of computational simulations \cite{Sommerville2006}.  A thorough discussion  of (V\&V) concepts and terminology during the last century can be found in \cite{Oberkampf2010}. In this thesis, the definitions provided by the \textit{American Society of Mechanical Engineers guide for Verification and Validation in Computational Solid Mechanics}  \cite{Schwer2006} are followed.

\begin{defn}
Verification: The process of determining that a computational model accurately represents
the underlying mathematical model and its solution. 
\end{defn}

\begin{defn}
Validation: The process of determining the degree to which a model is an accurate
representation of the real world from the perspective of the intended uses of the model. 
\end{defn}

Simplified \textit{verification} considers if one solves the equations right, while \textit{validation} is checking if one solves the right equations for the given problem \cite{Roache}. To test a computational code for all possible parameters, conditions and applications are simply too time consuming.   Verification and validation are therefore ongoing processes, with no clear boundary of completeness unless additional requirements are specified \cite{Roache}. The goal of this chapter is to verify our implementations using the method of manufactured solution  (MMS), addressing validation in a later chapter.

\section{Verification of Code}
Within scientific computing a mathematical model is often the baseline for simulations of a particular problem of interest. For scientists exploring physical phenomena, the mathematical model is often on the form of systems of partial differential equations (PDEs). A computer program therefore must evaluate  mathematical identities such a differential operators and functions in order to produce accurate solutions of the governing PDE´s. 
Through verification of code, the ultimate goal is to ensure a computer program truly represents the mathematical model. To accumulate sufficient evidence that a mathematical model is solved correctly by a computer code,  it must excel within predefined criteria. If the acceptance criterion is not satisfied, a coding mistake is suspected. Should the code pass the preset criteria, the code is considered verified. Of the different classes of test found in \cite{Roache},  \textit{Order-of-accuracy} (OAA)  is regarded as the most rigorous acceptance criterion for verification \cite{Biggs, Roache, Etienne2006}. The method tests if the discretization error $E$ is reduced in coordinance with the \textit{formal order of accuracy} expected from the numerical scheme. The formal order of accuracy is defined to be the theoretical rate at which the truncation error of a numerical scheme is expected to reduce. The \textit{observed order of accuracy} is the actual rate produced by the numerical solution. For order of convergence tests, the code is assumed to be verified if the observed discretization error is proportional to the formal order of accuracy.By monitoring the dicretization error $E$ by spatial and temporal refinements, OAA tests assumes the error $E$ can be expressed as,

\begin{align*}
&E = C\Delta t^p + D\Delta x^l\\
\end{align*} 
where C and D are is  constants, $\Delta t$ and $\Delta x$ represents the spatial and temporal resolution, while $p$ and $l$ is the convergence rate of the numerical scheme. If $\Delta x$is small compared to $\Delta t$, the spatial discretization error can be neglected, and we can use that to find $l$, which is the observed order of convergence for the temporal discretization error. To calculate the error $E$, an exact/reference solution is needed which rarely exist for complex mathematical models. The next subsection presents an efficient method for generating such solutions.

\subsection{Method of manufactured solution}
The basis of a convergence test is how to find an exact/reference solution, in order to compute the discretization error $E$. However solutions of PDEƒco-s are limited, and often simplifications of the original problem are needed to produce analytically solutions.  \textit{The method of manufactured solutions} provides a simple yet robust way of making analytic solutions for PDE´s. 
Let a  partial differential equation of interest be on the form
\begin{align*}
\textbf{L}(\textbf{u}) = \textbf{f}
\end{align*}

Here \textbf{L} is a differential operator, \textbf{u} is variable the of interest, and \textbf{f} is some sourceterm. In the method of manufactured solution one first manufactures a solution \textbf{u} for the given problem. In general, the choice of \textbf{u} will not satisfy the governing equations, producing a sourceterm  \textbf{f} after differentiation by \textbf{L}. The produced source term will cancel any imbalance formed by the manufactured solution \textbf{u} of the original problem. Therefore, the manufactured solution can be constructed without any physical reasoning, proving code verificaion as a purely a mathematical exercise were our only interest is to verify the solution \cite{Roache2002}. 
\newpage
If the MMS is not chosen properly the test will not work, therfore some guidelines for rigirous verification have been proposed in \cite{Etienne2006, Biggs, Roache2002}. 

\begin{itemize}
\item The manufactured solution (MS), should be composed of smooth analytic functions such as exponential, trigonometric, or polynomials.
\item The MS should should have sufficient number of derivatives, exercising all terms and derivatives of the PDE´s. 
\end{itemize}

To deeply verify the robustness of the method of manufactured solution,  a report regarding code verification by MMS for CFD was published by Salari and Knupp \cite{Biggs}. This thorough work applied the method for both compressible and incompressible time-dependent Navier-Stokes equation. To prove its robustness the authors deliberate implemented  code errors in a verified Navier-Stokes solver by MMS presented in the report. In total 21 blind testcases where implemented, where different approaches of verification frameworks were tested. 
Of these, 10 coding mistakes that reduces the observed order-of-accuracy was implemented. Here the method of manufactured solution captured all coding mistakes, except one. This mistake would, accordingly to the co-author, been captured if his guidelines for conducting MMS had been followed. \\

In general, computing the source term f can be quite challenging and error prone.  Therefore, symbolic computation of the sourcterm is advantigous to overcome mistakes which can easily occur when calulating by hand. For construction of the sourceterm \textbf{f}, the Unified Form Language (UFL) \cite{Alnes2015} provided in FEniCS Project will be used. COMPUTE VV HERE

\subsection{Comment on verification of the fluid-structure interaction solver by MMS}
In general the MMS does not need to match any physical processes. However, when considering multiphysics problems, such as FSI, the equations has to meet the mathematical criteria of the interface. \\

\textit{Let $\bat{v}_s, \bat{v}_f$ be the structure and fluid velocity, and let $\sigma_s$, $\sigma_f$ be the Cauchy stress tensor for the structure and fluid respectively. Let $\mathbf{n}_i$ be the normal vector pointing out of the domain $i$. We then have the following interface boundary conditions,}
\begin{enumerate}

\item Kinematic boundary condition $\bat{v}_s = \bat{v}_f$, enforced strongly by a continious velocity field in the fluid
        and solid domain.
\item Dynamic boundary condition $\sigma_s \cdot \mathbf{n}_s = \sigma_f \cdot \mathbf{n}_f$, enforced weakly by omitting the 
        boundary integrals from the weak formulation in problem.
\end{enumerate}
The choice of a MMS is therefore not trivial, as it must fulfill condition 1 and 2, in addition to the divergence-free condition in the fluid, and avoiding cancellation of the ALE-convective term $\pder{\hat{T}_f}{t}$.  The construction of a MMS for a monolithic FSI problem is therefore out of the scope of this thesis. The struggle is reflected of the abscence of research, regarding MMS for coupled FSI solvers in the litterature. The challenge are often disregarded, such as \cite{Sheldon2014}, where the verification process is conducted on the fluid and structure solver separately. Instead, the correctness of the coupling is evaluated by the code validation. The approach clearly ease the process, assuming verification of each codeblock is "sufficient" to declare the code verified. In this thesis, the approach found in \cite{Sheldon2014} was followed, but it must be stressed that solving each problem individually is not true verification, in reference to a monolithic approach where the problems are solved at the same time.

\section{Validation of Code}
Through \textit{verification}, one can assure that a scientific code implements a mathematical model correctly. However, correctness is unnecessary if the model fails to serve as an accurate representation of the physical problem of interest. 
By definition 1.2, \textit{Validation} is the act of demonstrating that a mathematical model is applicable for its intended use with a certain degree of accuracy. That is, a mathematical model is validated if it meets some predefined criteria within a specific context. Validation is therefore not intended to portray the model as an absolute truth, nor the best model available \cite{Rykiel1996}. In computational science, validation is conducted by comparing numerical results against existing experimental data. The design of validation experiments vary by the motivation of the of their creators, where validated experiments for computational science can be divided into three groups\cite{Sommerville2006}: (1)To improve fundamental understanding of a physical process, (2) Discovery or enhancement of mathematical models of well known physical processes, (3) to conclude the reliability and performance of systems. The assessment of comparison between numerical results and experimental data, makes \textit{validation} assess a wide range of issuses \cite{Sommerville2006} . Is the experiment relevant, and  conducted correctly in accordinance with prescribed parameters? What about the measurement uncertainty of reference experimental data? These issues  must be addressed in order to raise sufficient confidence that the mathematical model is credible for its intended use. \\

Validation of FSI is demanding due to the number of building blocks composing the full problem. For \textit{interface-tracking} methods such as the ALE-method, validation is not only related to the physical aspcets of the model. Even if the fluid and strucutre models excel well within predefined criteria, the non-physical nature of mesh moving models have proven to affect the numerical solution \cite{Wickb}. At first glance, this effect is surprising as mesh moving models simply describe the evolution of fluid mesh cells from the moving interface. However, each mesh model distributes the fluid cells differently, which in turn may have an important effect when conducting mathematical operations such as gradients. 
 \newpage
The numerical benchmark presented in \cite{Hron2006} has been chosen for validation of the \textit{One-step $\theta$} scheme from chapter 3. The benchmark has been widely accepted throughout the fluid-structure interaction community as a rigid validation benchmark \cite{Wickb, Wick, V2013, Gatzhammer2014}. This is mainly due to the diversity of tests included, challenging all the main components of a fluid-structure interaction scheme. The benchmark is based on the \textit{von Kármán vortex street} \cite{White}, where a cylinder is intentionally placed off center in a channel. In \cite{Hron2006}, an additional elastic flag is placed behind the cylinder, see Figure 4.1

\begin{figure}[h!]
  \centering
    \includegraphics[scale=0.2]{./Fig/turekflag.png}
      \caption{Computational domain of the validation benchmark}
\end{figure}

The benchmark is divided into three main test environments, further divided into three different problems with increasing difficulty. In the first environment the fluid solver is tested for a series of different flow profiles. The second environment considers the structure solver, regarding bending of the elastic flag. And the final environment concerns validation a full fluid-structure interaction problem.  Several quantites for comparion are presented in \cite{Hron2006} for validation purposes. 

\begin{itemize}
\item The position (x,y) of point A(t) as the elastic flag undergoes deformation.
\item Drag and lift forces exerted on of the whole interior geometry in contact with the fluid, consisting of the rigid circle and the elastic beam.
\begin{align*}
(F_D, F_L) = \int_{\Gamma} \mathbf{\sigma} \cdot \mathbf{n} dS
\end{align*}
\end{itemize}

\newpage
All environments pose both steady state and periodic solutions. For the steady state solutions, the quantity of interest will be calculated for the last time step. For the periodic solutions, the amplitude and mean values for the time dependent quantity are calculated from the last period of oscillations. The mean value and amplitude is given by,
\begin{align*}
\text{mean} = \frac{1}{2} \text{max + min} \\
\text{amplitude} = \frac{1}{2} \text{max - min}
\end{align*}
from the maximum and minimum value of the quantity of interest from the last period. In \cite{Hron2006}, all steady state solutions seems to be calulated by solving a steady state equation since time-step are only reported for the periodic solutions. In this thesis, all problems in \cite{Hron2006} are calculated by time integration. The main motivation is based upon that any given numerical errors regarding time integration will be intercepted at an earlier stage for a simpler problem. Therefore, the choice of time step  is chosen such that reasonable accuracy of the reference solution is attained.

 In the following section, an overview of each environment together with numerical results will be presented. A formal discussion of the results are given at the end of each simulation environment. For each table, the error of the finest spatial and temporal refinement compared to the reference solution is reported jn \cite{Hron2006}, and the followup work.

\subsection{Validation of fluid solver}
The first test environment conserns the fluid solver for low Reynold-number regime. Two approaches for the validation are given in \cite{Hron2006}. The first approach considers the setup as a fluid-structure interaction problem, by setting the elastic flag close to rigid  by manipulation of the structure parameters. In the second approach, the flag is set fully rigid and considered a purely flow problem.  By this proposal, no deformation of the fluid domain occurs, reducing the fluid variation formulation to its original form,


\begin{align*}
 \big( \pder{\bat{v}_f}{t}, \ \gat{\psi}^u \big)_{\hat{\Omega}_f} +
\femf{(\bat{v}_f \cdot \hat{\nabla}) \bat{v}_f}{\gat{\psi}^u}
- \femf{\hat{\sigma}}{\hat{\nabla}\gat{\psi}^u} -
\femf{\rho_f  \mathbf{f}_f}{{\gat{\psi}^u}} = 0 \\
\femf{\nabla \cdot \bat{v}_f)}{\gat{\psi}^p} = 0 
\end{align*} 

The latter approach is chosen for this thesis, as only the variational formulation for the fluid is tested and removes any influence of the structure and mesh extrapolation discretization. 
\newpage
\begin{table}[h!]
\centering
\label{my-label}
\begin{tabular}{ |p{3cm}||p{2cm}|p{2cm}|p{2cm}|  }
\hline
 parameter              & CFD 1 & CFD 2 & CFD 3 \\
 \hline
$\rho^f [10^{3}\frac{kg}{m^3}]$ & 1    & 1    & 1    \\
$\nu^f  [10^{-3}\frac{m^2}{s}]$  & 1    & 1    & 1    \\
U                      & 0.2  & 1    & 2    \\
Re                     & 20   & 100  & 200 \\
\hline
\end{tabular}
\caption{Fluid sub-problem parameters}
\end{table}
The validation of the fluid solver is divided into the three sub-cases; CFD1, CFD2, and CFD3, each with different fluid parameters shown in Figure 4.1 While  CFD1 and CFD2 yields steady state solutions, CFD3 is a periodic solution. A parabolic velocity profile on the form,
\begin{align*}
v_f(0, y) = 1.5 U\frac{(H -y)y}{(\frac{H}{2})^2}
\end{align*}
is set on the left channel inflow. H is the height of the channel, while the parameter U is set differently to each problem to induce different inlet flow profiles. At the right channel outflow, the pressure is set to $p = 0$. No-slip boundary conditions for the fluid are enforced on the channel walls, and on the inner geometry consisting of the circle and the elastic flag. The validation of the fluid solver is based on the evaluation of drag and lift forces on the inner geometry, in comparison with a reference solution. A spatial and temporal convergence study is conducted on all sub-cases The following tables presents the numerical results for each sub-case.

\subsubsection*{Results}
Table 4.2, 4.3, and 4.4 shows the numerical solution of each sub, CFD-1, CFD-2, and CFD-3. Each sub-problem is evaluated on for four different mesh with increasing resolution. For the numerical solution of CFD-3 in Table 4.4, additional temporal and spatial refinement studies are conducted. Figure 4.1 shows the evaluation of lift and drag for the finest spatial and temporal resolution, while Figure 4.3 shows a visual representation of the fluid flow through the channel. 

\begin{table}[h!]
\centering
\label{CFD 1 Results}
\begin{tabular}{ |p{1cm}||p{2.7cm}|p{3.3cm}|p{3.3cm}|}
\hline
  \multicolumn{4}{|c|}{$\Delta t = 0.1 \hspace{2mm} \theta = 1.0$} \\
\hline
nel & ndof & Drag  & Lift \\
\hline
 1438    & 6881   & 13.60 & 1.089  \\
 2899    & 13648  & 14.05 & 1.126 \\
 7501    & 34657  & 14.17   & 1.109 \\
 19365   & 88520  & 14.20 & 1.119 \\
  \hline
  \multicolumn{2}{|c|}{Reference}  & 14.29   & 1.119\\
   \hline
    \multicolumn{2}{|c|}{Error}  & 0.006 \%   & 0.00 \%\\
   \hline
\end{tabular}
\caption{CFD 1 results, lift and drag evaluated at the inner geometry surface for increasing spatial refinement. The error is computed as the relative error from the highest mesh resolution against the reference solution.}
\end{table}

\newpage

\begin{table}[h!]
\centering
\label{CFD-2 Results}
\begin{tabular}{ |p{1cm}||p{2.7cm}|p{3.3cm}|p{3.3cm}|}
 \hline
  \multicolumn{4}{|c|}{$\Delta t = 0.01 \hspace{2mm} \theta = 1.0$} \\
   \hline
nel & ndof & Drag  & Lift \\
\hline
 1438    & 6881 (P2-P1)  & 126.0 &  8.62 \\
 2899    & 13648  (P2-P1)& 131.8 & 10.89  \\
 7501    & 34657 (P2-P1) & 135.1 & 10.48  \\
 19365   & 88520(P2-P1)  & 135.7 & 10.55  \\
 \hline
  \multicolumn{2}{|c|}{Reference}  & 136.7   & 10.53\\
   \hline
    \multicolumn{2}{|c|}{Error}  & 0.007 \%   & 0.001 \%\\
   \hline
\end{tabular}
\caption{CFD 2 results, lift and drag evaluated at the inner geometry surface for increasing spatial refinement. The error is computed as the relative error from the highest mesh resolution against the reference solution.}
\end{table}

\begin{figure}[h!]
  \centering
    \includegraphics[scale=0.5]{./Fig/cfd3_liftdrag.png}
      \caption{CFD-3, lift and drag forces at time t = [9, 9.6]}
\end{figure}

\begin{figure}[h!]
  \centering
    \includegraphics[scale=0.2]{./Fig/cfd3.png}
      \caption{CFD-3, flow visualization of velocity time t = 9s}
\end{figure}

\newpage

\begin{table}[h!]
\centering
\label{CFD-3 Results}
\begin{tabular}{ |p{1cm}||p{2.9cm}|p{3.3cm}|p{3.3cm}|}
 \hline
  \multicolumn{4}{|c|}{$\Delta t = 0.01 \hspace{2mm} \theta = 0.5$} \\
   \hline
nel & ndof & Drag  & Lift \\
\hline
 1438    & 6881  (P2-P1)   & 417.23       +/-  0.0217 & -249.21       +/-  0.32  \\
   & 16474 (P3-P2)   & 414.86      $\pm$  5.6282 & -7.458      $\pm$  444.07  \\
 \hline
 2899    & 13648  (P2-P1) & 408.50  $\pm$   4.3029 & -19.731  $\pm$   373.45 \\  
     &  32853 (P3-P2)  & 432.86      $\pm$  5.5025 & -9.686      $\pm$  431.28  \\
  \hline
  7501    & 34657 (P2-P1) & 431.57  $\pm$   5.2627 & -12.497  $\pm$   429.76 \\    
    &  83955 (P3-P2)  & 438.20      $\pm$  5.5994 & -11.595      $\pm$  438.00 \\
    \hline
    19365   & 88520 (P2-P1) & 435.43  $\pm$   5.4133 & -11.545  $\pm$   438.89 \\
   &   215219 (P3-P2) & 438.80      $\pm$  5.6290 & -11.158      $\pm$  439.23 \\
\hline
 \multicolumn{2}{|c|}{Reference}  & 439.95 $\pm$ 5.6183 & -11.893 $\pm$ 437.81\\
 \hline
  \multicolumn{2}{|c|}{Error}  & 0.002 \% $\pm$ 0.001 \% & 0.061 \% $\pm$ 0.003\% \\
  \hline
  \end{tabular}
  \vspace{2cm}
 \begin{tabular}{ |p{1cm}||p{2.9cm}|p{3.3cm}|p{3.3cm}|}
  \hline
  \multicolumn{4}{|c|}{$\Delta t = 0.005 \hspace{2mm} \theta = 0.5$} \\
   \hline
nel & ndof & Drag  & Lift \\
\hline
 1438    & 6881  (P2-P1)   &  417.24  $\pm$  0.0084 & -249.386   $\pm$ 0.1345  \\
 1438    & 16474 (P3-P2)   & 414.90     $\pm$  5.7319 & -8.467 $\pm$  443.45  \\
\hline
 1438    &13648  (P2-P1)   & 408.27   $\pm$ 4.0192 & -18.981   $\pm$ 363.84 \\
 2899    &  32853 (P3-P2)   & 432.90      $\pm$  5.5333 & -11.382      $\pm$  430.60 \\
 \hline
 1438    & 34657  (P2-P1)   & 431.59 $\pm$5.2979 & -13.644   $\pm$ 429.68 \\
 7501    & 83955 (P3-P2)  & 438.23      $\pm$  5.6393 & -12.917 $\pm$  437.78 \\
 \hline
 1438    & 88520  (P2-P1)   & 435.46  $\pm$ 5.4579 & -13.190   $\pm$ 438.05 \\
 19365   & 215219 (P3-P2)  & 438.84    $\pm$  5.6576 & -12.786      $\pm$  438.36 \\
\hline
 \multicolumn{2}{|c|}{Reference}  & 439.95 $\pm$ 5.6183 & -11.893 $\pm$ 437.81\\
 \hline
  \multicolumn{2}{|c|}{Error}  & 0.002 \% $\pm$ 0.006 \% & 0.075 \% $\pm$ 0.001\% \\
  \hline
\end{tabular}
\caption{CFD 3 results, lift and drag evaluated at the inner geometry surface. A spatial refinement study is conducted for increasing mesh resolution and two different finite element pairs. The relative error is computed from the solution of the highest mesh resolution, against the reference solution.}
\end{table}
\newpage
\subsubsection*{Discussion of results}
The numerical solutions of CFD-1 in Figure 4.2 shows convergence against the reference solution. Choosing P2-P1 elements together with a fully implicit scheme $\theta = 1$, a relative error of $0.006 \%$ for lift, and $0\%$ for drag is attained. For the numerical solution of CFD-2 presented in Figure 4.3, the same observations apply. The second order crank-nicolson scheme  $\theta = 0.5$ was investigated for CFD1 and CFD2, however only improving the results of order $10^{-6}$ for both lift and drag. For the periodic problem CFD-3, the choice of  P2-P1 elements with a fully implicit time-stepping scheme proved insufficient for capturing the expected periodic solution.  By crank-nicolson time-stepping scheme $\theta = 0.5$, the periodic solution was attained. Since the choice of finite-element pair is not reported in the original work, both P3-P2 and P2-P1 element pairs for fluid and pressure respectively was compared in combination with spatial mesh refinement. From Table 4.3, a relative error $ < 0.08\%$ of the mean and amplitude for lift and drag is attained. The choice P3-P2 element pair is eminent to achieve reasonable results for the first and second mesh regardless of time step.  However, the third and fourth mesh resolution shows close resemblance with the reference solution, independent of finite-element pair. On basis of the presented results, the fluid solver is validated in accordance with the proposed benchmark. 

\subsection{Validation of solid solver}
The validation of the solid solver is conducted on a rectangular domain, representing the elastic structure behind the circle in Figure ?.  The structure is submitted to a gravitational for $\mathbf{g} = (0, g)$, while beeing fixed to a fictional wall on the left side of the domain. The validation of the solid solver is based on comparison of the deflection of point $A(t) = [A_x(t), A_y(t)]$,  conducted on three refined mesh, where the number of finite elements are chosen in close resemblance with the original work in \cite{Hron2006}. A simple investigation of different finite-element pairs, suggest that P3-P3 elements where used for making the reference solution. In this study, lower order finite-element pair was included by the motivation of shorter simulation time while retaining solution accuracy. While computational time is not a major concern for the solid solver, the study is important for potentially reducing the computational time for the final validation environment.

\begin{table}[h!]
\centering
\label{my-label}
\begin{tabular}{ |p{3cm}||p{2cm}|p{2cm}|p{2cm}|  }
 \hline
 parameter              & CSM 1 & CSM 2 & CSM 3 \\
 \hline
$\rho^s [10^{3}\frac{kg}{m^3}]$ & 1    & 1    & 1    \\
$\nu^s $  & 0.4    & 0.4    & 0.4    \\
$\mu^s  [10^{6}]$  & 0.5    & 2.0    & 0.5    \\
$g  \frac{m}{s^2}]$  & 2.0    & 2.0    & 2.0    \\
\hline
\end{tabular}
\caption{Solid sub-problem parameters}
\end{table}

\newpage

\begin{table}[h!]
\centering
\label{CSM 1 Results}
\begin{tabular}{ |p{1cm}||p{2.7cm}|p{3.3cm}|p{3.3cm}|}
\hline
  \multicolumn{4}{|c|}{$\Delta t = 0.1 \hspace{2mm} \theta = 1.0$} \\
\hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$] \\
\hline
 319     & 832 P1-P1  & -5.278 &  -56.6 \\
     & 2936 P2-P2 & -7.056 &  -65.4 \\
      & 6316 P3-P3 &  -7.064 &   -65.5  \\
 \hline
  1365    & 3140 P1-P1  & -6.385 &  -62.2 \\
     & 11736 P2-P2 & -7.075 &  -65.5 \\
     & 25792 P3-P3 & -7.083 &  -65.5 \\
 \hline
  5143    & 11084 P1-P1 & -6.905 &  -64.7  \\
     & 42736 P2-P2 & -7.083 &  -65.4\\
     & 94960 P3-P3 & -7.085 &  -65.5  \\
  \hline
  \multicolumn{2}{|c|}{Reference}  &-7.187    & -66.1 \\
   \hline
    \multicolumn{2}{|c|}{Error}  & 1.41 \%   & 0.8 \%\\
   \hline
\end{tabular}
\caption{CSM-1, deformation components of A(t) for $\Delta t = 0.1$ and increasing spatial refinement. The error is computed as the relative error from the highest mesh resolution against the reference solution.}
\end{table}

\begin{table}[h!]
\centering
\label{CSM 2 Results}
\begin{tabular}{ |p{1cm}||p{2.7cm}|p{3.3cm}|p{3.3cm}|}
\hline
  \multicolumn{4}{|c|}{$\Delta t = 0.05 \hspace{2mm} \theta = 1.0$} \\
\hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$] \\
\hline

 319     & 832 P1-P1  & -0.3401 &  -14.43  \\ 
     & 2936 P2-P2 &  -0.460  &  -16.78  \\ 
      & 6316 P3-P3 & -0.461 &  -16.79  \\
        \hline
  1365    & 3140 P1-P1  &  -0.414 &  -15.93\\
     & 11736 P2-P2 &  -0.461 &  -16.81 \\
     & 25792 P3-P3 & -0.461  &  -16.82 \\
        \hline
   5143    & 11084 P1-P1 & -0.449 &  -16.60  \\
     & 42736 P2-P2 &-0.461 &  -16.82 \\
     & 94960 P3-P3 & -0.462 &  -16.82 \\
  \hline
  \multicolumn{2}{|c|}{Reference}  & -0.469      & -16.97  \\
   \hline
    \multicolumn{2}{|c|}{Error}  & 1.49\%   & 0.88 \%\\
   \hline
\end{tabular}
\caption{CSM-2, deformation components of A(t) for $\Delta t = 0.05$ and increasing spatial refinement. The error is computed as the relative error from the highest mesh resolution against the reference solution.}
\end{table}

\newpage

\begin{table}[h!]
\centering
\label{CSM 3 Results}
\begin{tabular}{ |p{1cm}||p{2.7cm}|p{3.3cm}|p{3.3cm}|}
\hline
  \multicolumn{4}{|c|}{$\Delta t = 0.02 \hspace{2mm} \theta = 0.5$} \\
\hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$] \\
\hline
 319     & 832 P1-P1  & -10.790       +/-  10.797 & -55.184       +/-  56.682 \\
     & 2936 P2-P2 & -14.380       +/-  14.387 & -63.198       +/-  65.147 \\
      & 6316 P3-P3 & -14.409       +/-  14.417 & -63.288       +/-  65.225 \\
  \hline
   1365    & 3140 P1-P1 & -13.032       +/-  13.041 & -60.446       +/-  62.075 \\
     & 11736 P2-P2 & -14.407       +/-  14.416 & -63.283       +/-  65.220 \\
     & 25792 P3-P3 & -14.412       +/-  14.421 & -63.310       +/-  65.246 \\
   \hline
    5143    & 11084 P1-P1 & -14.059       +/-  14.071 & -62.591       +/-  64.473 \\
     & 42736 P2-P2  & -14.412       +/-  14.421 & -63.313       +/-  65.249 \\
     & 94960 P3-P3 & -14.416       +/-  14.425 & -63.328       +/-  65.263 \\
    \hline
  \multicolumn{2}{|c|}{Reference}  &-14.305 +- -14.305        & -63.607 +- 65.160    \\
   \hline
    \multicolumn{2}{|c|}{Error}  & \%   &  \%\\
   \hline
\end{tabular}
\end{table}

\begin{table}[h!]
\centering
\label{CSM 3 Results 2}
\begin{tabular}{ |p{1cm}||p{2.7cm}|p{3.3cm}|p{3.3cm}|}
\hline
  \multicolumn{4}{|c|}{$\Delta t = 0.01 \hspace{2mm} \theta = 0.5$} \\
\hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$] \\
\hline
    319     & 832 P1-P1 & -10.835       +/-  10.836 & -55.197       +/-  56.845 \\
     & 2936 P2-P2 & -14.390       +/-  14.392 & -63.303       +/-  65.149 \\
      & 6316 P3-P3& -14.432       +/-  14.435 & -63.397       +/-  65.263 \\
    \hline
    1365    & 3140 P1-P1  & -13.053       +/-  13.054 & -60.367       +/-  62.241 \\
     & 11736 P2-P2  & -14.428       +/-  14.432 & -63.388       +/-  65.256 \\
     & 25792 P3-P3  & -14.444       +/-  14.446 & -63.432       +/-  65.287 \\
     \hline
     5143    & 11084 P1-P1 & -14.082       +/-  14.084 & -62.656       +/-  64.495 \\
     & 42736 P2-P2 & -14.444       +/-  14.447 & -63.435       +/-  65.288 \\
     & 94960 P3-P3& -14.449       +/-  14.452 & -63.449       +/-  65.296 \\
 \hline
  \multicolumn{2}{|c|}{Reference}  &-14.305 +- -14.305        & -63.607 +- 65.160    \\
   \hline
    \multicolumn{2}{|c|}{Error}  & \%   &  \%\\
   \hline
\end{tabular}
\end{table}

\newpage

\begin{table}[h!]
\centering
\label{CSM 3 Results 3}
\begin{tabular}{ |p{1cm}||p{2.7cm}|p{3.3cm}|p{3.3cm}|}
\hline
  \multicolumn{4}{|c|}{$\Delta t = 0.005 \hspace{2mm} \theta = 0.5$} \\
\hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$] \\
\hline
    319     & 832 P1-P1 & -10.846       +/-  10.848 & -56.049       +/-  56.053 \\
     & 2936 P2-P2  & -14.390       +/-  14.391 & -63.738       +/-  64.703 \\
      & 6316 P3-P3 & -14.429       +/-  14.430 & -63.833       +/-  64.810 \\
 \hline 
    1365    & 3140 P1-P1 & -13.057       +/-  13.057 & -60.813       +/-  61.826 \\
     & 11736 P2-P2& -14.426       +/-  14.427 & -63.827       +/-  64.801 \\
     & 25792 P3-P3 & -14.440       +/-  14.441 & -63.854       +/-  64.845 \\
 \hline
      5143    & 11084 P1-P1 & -14.091       +/-  14.091 & -63.195       +/-  63.981 \\
     & 42736 P2-P2 & -14.441       +/-  14.441 & -63.856       +/-  64.847 \\
     & 94960 P3-P3 & -14.446       +/-  14.446 & -63.865       +/-  64.860 \\
 \hline
  \multicolumn{2}{|c|}{Reference}  &-14.305 +- -14.305        & -63.607 +- 65.160    \\
   \hline
    \multicolumn{2}{|c|}{Error}  & \%   &  \%\\
   \hline
\end{tabular}
\caption{CSM-3, deformation components of A(t) for  increasing temporal and spatial refinement. The error is computed as the relative error from the highest mesh resolution for each choice of time step.}
\end{table}

\begin{figure}[h!]
  \centering
    \includegraphics[scale=0.6]{./Fig/csm3compare.png}
      \caption{CSM-3, deformation components of A(t) for two different time intervals. Time interval $t \in [0, 6]$ shows the P3-P3 element pair, while$t \in [6, 8]$ compares all finite elemet pair chosen for the experiment}
\end{figure}

\subsubsection*{Discussion of results}
The results for sub-problems CSM-1 and CSM-2 each coincide with the reference solution. The study of lower-grade elements proved successful for both problems, justifying accurate results can be achieved for polynomials grade 1 and 2 for all mesh refinements. This observation is further justified in the CSM-3 results. In table 1.4, the  displacement components of P3-P3 and P2-P2 elements can hardly be distinguished.


\newpage
\subsection{Validation of fluid structure interaction solver}
The validation of the FSI solver constist of three sub-cases which will be referred to FSI-1, FSI-2 and FSI-3. The FSI-1 environment yields a steady state solution for the system, inducing small deformations to the elastic flag. This environment is excellent to ensure the overall coupling of the FSI-problem is executed properly. The FSI-2 and FSI-3 environment results in a periodic solution, where the elastic flag oscilates behind the sylinder.


 For all sub-cases
a parabolic velocity profile on the form,
\begin{align*}
v_f(0, y) = 1.5 U\frac{(H -y)y}{(\frac{H}{2})^2}
\end{align*}
is set on the left channel inflow. H is the height of the channel, while the parameter U is set differently to each problem to induce different flow profiles. \
At the right channel outflow, the pressure is set to $p = 0$. \
No-slip boundary conditions for the fluid are enforced on the channel walls, and on the circle of the inner geometry.
The structure deformation and velocity is set to zero on the left side of the flag, where the flag is ancored to the circle. On the fluid-structure interface $\Gamma$, we enfore the kinematic and dynamic boundary condition
\begin{align}
\mathbf{v}_f = \mathbf{v}_s \\
\mathbf{\sigma}_f \cdot \mathbf{n} = \mathbf{\sigma}_s \cdot \mathbf{n}
\end{align}
From chapter ?,  (1.1) is enforced strongly due to the continious velocity field, while (1.2) is enforced weakly by omtitting form the weak formulation by.



Apart from the accuracy of the reported values, the main purpose of the validation of the fluid solver is twofold. Firstly, it is of great importance to ensure that the overall coupling of the fluid-structure interaction problem are executed correctly. Second, a good choice of mesh extrapolation model is essential to ensure that mesh entanglement is not present. Based on the experience with the previous sub-problems, the finite element group of P2-P2-P1 is chosen for deformation, velocity and pressure  . 


\begin{table}[h!]
\centering
\caption{Benchmark environment}
\label{my-label}
\begin{tabular}{ |p{3cm}||p{2cm}|p{2cm}|p{2cm}|  }
 \hline
 \multicolumn{4}{|c|}{Solid parameters} \\
 \hline
 parameter              & FSI1 & FSI2 & FSI3 \\
 \hline
 $\rho^s [10^{3} \frac{kg}{m^3}]$ & 1    & 10   & 1    \\
$\nu^s$ & 0.4  & 0.4  & 0.4  \\
$\mu^s  [10^{6}\frac{kg}{ms^2}]$  & 0.5  & 0.5  & 2.0  \\
 \hline
 \multicolumn{4}{|c|}{Fluid parameters} \\
 \hline
$\rho^f [10^{3}\frac{kg}{m^3}]$ & 1    & 1    & 1    \\
$\nu^f  [10^{-3}\frac{m^2}{s}]$  & 1    & 1    & 1    \\
U                      & 0.2  & 1    & 2    \\
parameter              & FSI1 & FSI2 & FSI3 \\
Re                     & 20   & 100  & 200 \\
\hline
\end{tabular}
\end{table}

\newpage
\subsubsection{FSI1}


\begin{table}[h!]
\centering
\caption{FSI 1 Results}
\label{FSI1 Results}
\begin{tabular}{ |p{1cm}||p{1cm}|p{2.5cm}|p{2.5cm}|p{2.7cm}|p{2.7cm}|p{1.2cm}|}
 \hline
  \multicolumn{6}{|c|}{Laplace} \\
   \hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 \hline
 2474    & 21249  &       0.0226 &       0.8200 & 14.061 & 0.7542 \\
 7307    & 63365  &       0.0227 &       0.7760 & 14.111 & 0.7517 \\
 11556   & 99810  &       0.0226 &      0.8220 & 14.201 & 0.7609 \\
  \hline
 \multicolumn{2}{|c|}{Reference} &  0.0227      &       0.8209      & 14.295  & 0.7638   \\
 \hline
\end{tabular}
\begin{tabular}{ |p{1cm}||p{1cm}|p{2.5cm}|p{2.5cm}|p{2.7cm}|p{2.7cm}|p{1.2cm}|}
 \hline
  \multicolumn{6}{|c|}{Linear Elastic} \\
   \hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 \hline
 2474    & 21249  &       0.0226 &       0.8198 & 14.061 & 0.7541 \\
 7307    & 63365  &       0.0227 &       0.7762 & 14.111 & 0.751  \\
 11556   & 99810  &       0.0226  &       0.8222 & 14.201 & 0.7609 \\
  \hline
 \multicolumn{2}{|c|}{Reference} &  0.0227      &       0.8209      & 14.295  & 0.7638   \\
 \hline
\end{tabular}
\begin{tabular}{ |p{1cm}||p{1cm}|p{2.5cm}|p{2.5cm}|p{2.7cm}|p{2.7cm}|p{1.2cm}|}
 \hline
  \multicolumn{6}{|c|}{Biharmonic bc1} \\
   \hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 \hline
 2474    & 21249  &       0.0226 &       0.8200 & 14.061 & 0.7541 \\
 7307    & 63365  &       0.0227  &       0.7761 & 14.111 & 0.7517 \\
 11556   & 99810  &       0.0227  &       0.8017 & 14.205 & 0.9248 \\
  \hline
 \multicolumn{2}{|c|}{Reference} &  0.0227      &       0.8209      & 14.295  & 0.7638   \\
 \hline
\end{tabular}
\begin{tabular}{ |p{1cm}||p{1cm}|p{2.5cm}|p{2.5cm}|p{2.7cm}|p{2.7cm}|p{1.2cm}|}
 \hline
  \multicolumn{6}{|c|}{Biharmonic bc2} \\
   \hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 \hline
 2474    & 21249  &       0.0226 &       0.8200 & 14.061 & 0.7543 \\
 7307    & 63365  &       0.0227 &       0.7761 & 14.111 & 0.7518 \\
 11556   & 99810  &       0.0227 &       0.8020 & 14.205 & 0.9249  \\
  \hline
 \multicolumn{2}{|c|}{Reference} &  0.0227      &       0.8209      & 14.295  & 0.7638   \\
 \hline
\end{tabular}
\end{table}


\begin{table}[h!]
\centering
\caption{FSI 1 - No extrapolation}
\label{FSI1- No extrapolation}
\begin{tabular}{ |p{1cm}||p{1cm}|p{2.5cm}|p{2.5cm}|p{2.7cm}|p{2.7cm}|p{1.2cm}|}
 \hline
  \multicolumn{6}{|c|}{No extrapolation} \\
   \hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 \hline
 2474    & 21249  &       0.0224 &       0.9008 & 14.064 & 0.7713 \\
 7307    & 63365  &       0.0226  &       0.8221 & 14.117 & 0.7660 \\
 11556   & 99810  &       0.0225 &       0.8787 & 14.212 & 0.7837 \\
  \hline
 REF     & REF    &       0.0227      &       0.8209      & 14.295  & 0.7638   \\
 \hline
\end{tabular}

\end{table}




\newpage \newpage
\subsubsection{FSI2}
FSI2
\begin{figure}[h!]
  \centering
    \includegraphics[scale=0.2]{./Fig/fsi2flow.png}
      \caption{FSI-2, visualization of fully developted flow with structure deformation at time t = 9s}
\end{figure}

\newpage
\subsubsection{FSI3}

\begin{table}[h!]
\centering
\caption{FSI 3 - Comparison of mesh extrapolation models}
\label{my-label}
\begin{tabular}{ |p{1cm}||p{1cm}|p{2.5cm}|p{2.5cm}|p{2.7cm}|p{2.7cm}|p{1.2cm}|}
 \hline
  \multicolumn{6}{|c|}{Laplace \hspace{2mm} $\Delta t = 0.01 \theta = 0.51$} \\
   \hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 \hline
 2474    & 21249  & -2.41      $\pm$ 2.41 & 1.49       $\pm$ 3.22 & 449.40       $\pm$ 14.70 & 0.55       $\pm$ 155.80  \\
 7307    & 63365  & -2.32       $\pm$ 2.30 & 1.34       $\pm$ 3.17 & 451.78       $\pm$ 16.08 & 1.13       $\pm$ 151.22  \\
 11556   & 99810  & -2.34       $\pm$ 2.34 & 1.57       $\pm$ 3.19 & 455.92       $\pm$ 17.32 & -0.10       $\pm$ 151.03 \\
 \hline
  \multicolumn{6}{|c|}{$\Delta t = 0.001 \theta = 0.501$} \\
   \hline
 nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
    \hline
1216 &5797& --2.17$\pm$  2.08 &     3.32     $\pm$  29.07 &439.98 $\pm$  14.08  &  1.91 $\pm$  151.71\\
2295 &10730& -3.04 $\pm$  2.88 &  1.51  $\pm$  35.88 & 452.04  $\pm$  22.41 &  3.30      $\pm$  160.11 \\
5963 &27486 & -3.03$\pm$  2.85 &  1.23 $\pm$  35.97  & 459.45  $\pm$  23.80 &  1.53  $\pm$  160.14 \\
 \hline
  \multicolumn{2}{|c|}{Reference}  & 136.7   & 10.53 & &\\
   \hline
    \multicolumn{2}{|c|}{Error}  & 0.007 \%   & 0.001 \% & &\\
   \hline
\end{tabular}
\end{table}

\begin{table}[h!]
\centering
%\caption{FSI 3 - Biharmonic BC1}
\label{my-label}
\begin{tabular}{ |p{0.9cm}||p{0.9cm}|p{2.49cm}|p{2.49cm}|p{2.6cm}|p{2.8cm}|}
 \hline
  \multicolumn{6}{|c|}{Biharmonic 1 \hspace{2mm}  $\Delta t = 0.01 \theta = 0.51$} \\
   \hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 \hline
 %2474    & 21249 & 7.96  $\pm$ 8.10  & -3.84   $\pm$ 1.02 & 450.16  $\pm$ 15.11 & $-20.09 \pm 148.17 $\\
 2474     &21249  &7.96  $\pm$ 8.10  &  -3.84   $\pm$ 1.02 & 450.16  $\pm$ 15.11  & -20.09 $\pm$ 148.17 \\
 7307    & 63365  & 3.10  $\pm$ 3.06  & -1.90   $\pm$ 4.21 & 457.37  $\pm$ 15.24 & -51.77 $\pm$ 127.28 \\
 11556   & 99810  & -2.18  $\pm$ 9.65 & 1.31    $\pm$ 4.93  & 456.40 $\pm$ 17.45 &  0.45 $\pm$ 149.68  \\
 \hline
  \multicolumn{6}{|c|}{$\Delta t = 0.001 \theta = 0.5$} \\
   \hline
 nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
1216 &5797  & -2.18       $\pm$ 2.10 & 3.56   $\pm$ 2.90 & 435.19       $\pm$ 9.77  & -1.57       $\pm$ 151.43 \\
7307    & 63365  & -1.42  $\pm$ 4.70 & 7.77   $\pm$ 2.85 & 454.38       $\pm$ 19.75 & 17.97       $\pm$ 155.08 \\
11556   & 99810  & -2.23  $\pm$ 6.16 & 1.72   $\pm$ 4.48 & 459.12       $\pm$ 22.97 & -3.12       $\pm$ 171.22 \\
 \hline
 \multicolumn{2}{|c|}{Reference} & -2.69 $\pm$  2.56                    & 1.48  $\pm$  34.38                   & 457.3  $\pm$  22.66        & 2.22  $\pm$- 149.78           \\
 \hline
 \multicolumn{2}{|c|}{Error}  & 0.007 \%   & 0.001 \% & &\\
 \hline
\end{tabular}
\end{table}

\begin{table}[h!]
\centering
%\caption{FSI 3 - Biharmonic BC2}
\label{my-label}
\begin{tabular}{ |p{1cm}||p{1cm}|p{2.5cm}|p{2.5cm}|p{2.7cm}|p{2.7cm}|p{1.2cm}|}
 \hline
  \multicolumn{6}{|c|}{Biharmonic 2 \hspace{2mm}  $\Delta t = 0.01 \theta = 0.51$} \\
   \hline
nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 \hline
1216 &5797& -1.74  $\pm$  1.76 & 3.56 $\pm$  26.01 & 439.41$\pm$ 12.21  & -1.35    $\pm$  138.74\\
2295 &10730 & -2.39   $\pm$  2.40 &  1.76  $\pm$  32.27 & 449.71$\pm$ 18.16 &  3.71   $\pm$  149.97\\
 \hline
  \multicolumn{6}{|c|}{$\Delta t = 0.001 \theta = 0.501$} \\
   \hline
 nel & ndof & ux of A [x $10^{3}$]  &uy of A [x $10^{3}$]& Drag  & Lift \\
 1216 &5797& -3.39   $\pm$  3.38 &   1.23   $\pm$  36.61 &   413.26 $\pm$  51.82  &   57.19  $\pm$  222.65\\
 2295 &10730& -4.70  $\pm$  4.71& 1.49       $\pm$  44.62& 427.91$\pm$  93.17 &  44.38  $\pm$  268.05 \\
 \hline
 \multicolumn{2}{|c|}{Reference} & -2.69 $\pm$  2.56                    & 1.48  $\pm$  34.38                   & 457.3  $\pm$  22.66        & 2.22  $\pm$- 149.78           \\
 \hline
 \multicolumn{2}{|c|}{Error}  & 0.007 \%   & 0.001 \% & &\\
 \hline
\end{tabular}
\end{table}


\begin{figure}[h!]
    \includegraphics[scale=0.75]{./Fig/fsi3liftcompare.png}
      \caption{Comparing mesh extrapolation models}
\end{figure}

\begin{figure}[h!]
  \centering
    \includegraphics[scale=0.2]{./Fig/fsi3flow.png}
      \caption{FSI-3, visualization of fully developted flow with structure deformation at time t = 5.1s}
\end{figure}

\newpage
\subsubsection*{Discussion of results}
Considering FSI1, all mesh extraplation models are of high accuracy compared to the reference solution.  However, due to the small deformations of order $10^{-6}$, FSI1 doesn't provide a rigorous test for testing mesh extrapolation models. By omitting mesh extrapolation from the variatonal formulation,  reasonable results are still obtained. Therefore, the  FSI-1 validation case can be misguiding, in terms of validating the chosen mesh extrapolation model. 

The FSI2 case proved to be one of the most demanding tests, due to the large deformation of the elastic flag. leading to the risk of entangled mesh cells. Therefore a high quality extrapolation of the solid deformation into the fluid is needed. All mesh extrapolation models proved to

The FSI3 environment does not induce deformation to the extent of the FSI2. However a critical phase in the transition to the periodic solution was discovered, where the pressure oscillation induces a large deformation to the system.










 

